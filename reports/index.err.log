Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/asyncio/base_events.py", line 647, in run_until_complete
    return future.result()
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
from policyengine_uk.api import *


def change_tax_parameters(parameters):
    parameters.gov.hmrc.income_tax.rates.uk.brackets[0].rate.update(
        period=periods.period("year:2019:10"), value=0.23
    )
    return parameters


class reform(Reform):
    def apply(self):
        self.modify_parameters(change_tax_parameters)


baseline = Microsimulation()
reformed = Microsimulation(reform)
revenue = reformed.calc("tax").sum() - baseline.calc("tax").sum()
f"Revenue: Â£{round(revenue / 1e+9, 1)}bn"
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mTypeError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[2], line 17[0m
[1;32m     13[0m         [38;5;28mself[39m[38;5;241m.[39mmodify_parameters(change_tax_parameters)
[1;32m     16[0m baseline [38;5;241m=[39m Microsimulation()
[0;32m---> 17[0m reformed [38;5;241m=[39m [43mMicrosimulation[49m[43m([49m[43mreform[49m[43m)[49m
[1;32m     18[0m revenue [38;5;241m=[39m reformed[38;5;241m.[39mcalc([38;5;124m"[39m[38;5;124mtax[39m[38;5;124m"[39m)[38;5;241m.[39msum() [38;5;241m-[39m baseline[38;5;241m.[39mcalc([38;5;124m"[39m[38;5;124mtax[39m[38;5;124m"[39m)[38;5;241m.[39msum()
[1;32m     19[0m [38;5;124mf[39m[38;5;124m"[39m[38;5;124mRevenue: Â£[39m[38;5;132;01m{[39;00m[38;5;28mround[39m(revenue[38;5;250m [39m[38;5;241m/[39m[38;5;250m [39m[38;5;241m1e+9[39m,[38;5;250m [39m[38;5;241m1[39m)[38;5;132;01m}[39;00m[38;5;124mbn[39m[38;5;124m"[39m

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:131[0m, in [0;36mSimulation.__init__[0;34m(self, tax_benefit_system, populations, situation, dataset, dataset_year, reform)[0m
[1;32m    129[0m     [38;5;28mself[39m[38;5;241m.[39mdataset [38;5;241m=[39m dataset
[1;32m    130[0m     [38;5;28mself[39m[38;5;241m.[39mdataset_year [38;5;241m=[39m dataset_year
[0;32m--> 131[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mbuild_from_dataset[49m[43m([49m[43m)[49m
[1;32m    133[0m [38;5;66;03m# Backwards compatibility methods[39;00m
[1;32m    134[0m [38;5;28mself[39m[38;5;241m.[39mcalc [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mcalculate

File [0;32m/opt/hostedtoolcache/Python/3.9.16/x64/lib/python3.9/site-packages/policyengine_core/simulations/simulation.py:172[0m, in [0;36mSimulation.build_from_dataset[0;34m(self)[0m
[1;32m    169[0m [38;5;28;01mdef[39;00m [38;5;21mbuild_from_dataset[39m([38;5;28mself[39m) [38;5;241m-[39m[38;5;241m>[39m [38;5;28;01mNone[39;00m:
[1;32m    170[0m [38;5;250m    [39m[38;5;124;03m"""Build a simulation from a dataset."""[39;00m
[1;32m    171[0m     [38;5;28mself[39m[38;5;241m.[39mbuild_from_populations(
[0;32m--> 172[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mtax_benefit_system[49m[38;5;241;43m.[39;49m[43minstantiate_entities[49m[43m([49m[43m)[49m
[1;32m    173[0m     )
[1;32m    174[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mpolicyengine_core[39;00m[38;5;21;01m.[39;00m[38;5;21;01msimulations[39;00m[38;5;21;01m.[39;00m[38;5;21;01msimulation_builder[39;00m [38;5;28;01mimport[39;00m (
[1;32m    175[0m         SimulationBuilder,
[1;32m    176[0m     )  [38;5;66;03m# Import here to avoid circular dependency[39;00m
[1;32m    178[0m     builder [38;5;241m=[39m SimulationBuilder()

[0;31mTypeError[0m: instantiate_entities() missing 1 required positional argument: 'self'
TypeError: instantiate_entities() missing 1 required positional argument: 'self'

